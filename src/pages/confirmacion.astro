---
import LayoutBasic from '../layouts/LayoutBasic.astro';
import ConfirmacionSeccion from '../components/confirmacion/ConfirmacionSeccion.jsx';

// Obtener query params
const url = Astro.url;
const transactionId = url.searchParams.get('transaction_id') || url.searchParams.get('receipt_id');
const leadIdRaw = url.searchParams.get('lead_id');
const paymentMethod = url.searchParams.get('method') || 'unknown';
const status = url.searchParams.get('status') || 'confirmed';

// Parsear leadId correctamente
const leadId = leadIdRaw ? parseInt(leadIdRaw, 10) : null;

// Log en servidor (solo se ve en terminal de Astro)
console.log('üîç confirmacion.astro - Query params:', {
  transactionId,
  leadIdRaw,
  leadId,
  paymentMethod,
  status
});

// ‚ö†Ô∏è SIEMPRE pasar true - la validaci√≥n real se hace en React despu√©s de intentar localStorage
// Esto permite que el componente React intente recuperar los datos de localStorage
const hasData = true;

console.log('‚úÖ confirmacion.astro - hasData (always true for fallback):', hasData);
---

<LayoutBasic 
  title="Confirmaci√≥n de Registro - Congreso Nacional de Amparo 2025" 
  showFooter={true}
>
  <ConfirmacionSeccion 
    client:only="react"
    transactionId={transactionId}
    leadId={leadId}
    paymentMethod={paymentMethod}
    status={status}
    hasData={hasData}
  />
</LayoutBasic>